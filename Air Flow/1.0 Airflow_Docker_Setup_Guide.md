
# Apache Airflow Setup Using Docker – Step-by-Step Guide (Beginner to Advanced)

## 1. What is Apache Airflow?
Apache Airflow is an open-source workflow orchestration tool used to schedule, monitor, and manage data pipelines.

## 2. Why Install Airflow Using Docker?
- No dependency conflicts  
- All Airflow services run inside containers  
- Works on Windows/Mac/Linux  
- Easy to delete/reset  

## 3. Prerequisites
- Docker  
- Docker Compose  
- Minimum 4GB RAM  
- Python 3.8+ (optional for virtualenv)

## 4. Create Airflow Project Folder
### Windows PowerShell:
```
mkdir airflow_project
cd airflow_project
```

### Ubuntu/macOS:
```
mkdir airflow_project
cd airflow_project
```

## 5. Download Airflow Docker Compose File
### Ubuntu/macOS:
```
curl -LfO "https://airflow.apache.org/docs/apache-airflow/2.8.1/docker-compose.yaml"
```

### Windows PowerShell:
```
Invoke-WebRequest -Uri "https://airflow.apache.org/docs/apache-airflow/2.8.1/docker-compose.yaml" -OutFile "docker-compose.yaml"
```

## 6. Create Required Directories
```
mkdir dags logs plugins
```

## 7. (Linux Only) Set Airflow UID
```
echo -e "AIRFLOW_UID=$(id -u)" > .env
```

## 8. Initialize Airflow
```
docker compose up airflow-init
```

## 9. Start Airflow Services
```
docker compose up
```
or background:
```
docker compose up -d
```

## 10. Open Airflow UI
Open:  
`http://localhost:8080`

Login:  
Username: `airflow`  
Password: `airflow`

## 11. Where to Place DAG Files?
Place DAG .py files inside:
```
airflow_project/dags/
```

## 12. Sample DAG
```
from airflow import DAG
from airflow.operators.bash import BashOperator
from datetime import datetime

with DAG(
    dag_id="my_first_dag",
    start_date=datetime(2024, 1, 1),
    schedule_interval="@daily",
    catchup=False
):

    task1 = BashOperator(
        task_id="hello",
        bash_command="echo 'Hello Airflow'"
    )
```

## 13. Stop Airflow
```
docker compose down
```

## 14. Reset/Delete Everything
```
docker compose down --volumes --remove-orphans
```

## Common Errors & Fixes

| Error | Reason | Fix |
|------|--------|------|
| curl -LfO not working (Windows) | PowerShell incompatible | Use Invoke-WebRequest |
| no such service airflow-init | Wrong directory | Ensure docker-compose.yaml is inside airflow_project |
| Permission denied logs | Linux UID mismatch | Add .env with AIRFLOW_UID |
| UI not loading | Port 8080 conflict | Change port in compose file |

## Final Directory Structure
```
airflow_project/
│── dags/
│── logs/
│── plugins/
│── docker-compose.yaml
│── .env
```
