
# ⭐ Explanation of VectorAssembler in PySpark

The following code prepares your telecom churn dataset for **Machine Learning** using PySpark:

```python
from pyspark.ml.feature import VectorAssembler

assembler = VectorAssembler(
    inputCols=["monthly_charge", "tenure_months", "support_calls"],
    outputCol="features"
)

df_ml = assembler.transform(df).select("features", "churn")
df_ml.show()
```

---

# ⭐ 1. Why Do We Need VectorAssembler?

Machine Learning models in PySpark (Logistic Regression, Random Forest, etc.)  
**cannot accept multiple individual columns as input**.

They require all input features to be combined into **one vector column** called `"features"`.

### Example Conversion

| monthly_charge | tenure_months | support_calls |
|----------------|----------------|----------------|
| 899            | 24             | 1              |

Becomes:

| features           |
|--------------------|
| [899.0, 24.0, 1.0] |

This vector format is required by Spark ML algorithms.

---

# ⭐ 2. Creating the VectorAssembler

```python
assembler = VectorAssembler(
    inputCols=["monthly_charge", "tenure_months", "support_calls"],
    outputCol="features"
)
```

### Explanation

- **inputCols** → Columns used to predict churn  
- **outputCol** → Name of the vector column Spark ML will use  
- Combines multiple numeric columns into one array

---

# ⭐ 3. Transform the DataFrame

```python
df_ml = assembler.transform(df).select("features", "churn")
```

### What happens here?

1. `assembler.transform(df)`  
   - Adds a new column called `"features"` containing the combined vector.

2. `.select("features", "churn")`  
   - Selects only:
     - **features** → independent variables (X)  
     - **churn** → target label (Y)

This becomes your final dataset for training.

---

# ⭐ 4. Output Example

```
+---------------------+-----+
| features            |churn|
+---------------------+-----+
|[899.0,24.0,1.0]     | 0   |
|[1299.0,6.0,5.0]     | 1   |
|[699.0,12.0,2.0]     | 0   |
|[1599.0,3.0,6.0]     | 1   |
|[499.0,30.0,0.0]     | 0   |
+---------------------+-----+
```

---

# ⭐ Summary to Remember

| Step | Meaning |
|------|---------|
| **VectorAssembler** | Combines multiple columns into one feature vector |
| **inputCols** | Input feature columns |
| **outputCol** | Vector column name |
| **transform()** | Applies transformation to DataFrame |
| **select()** | Keeps only required ML columns |

---

# ⭐ Why this is important?

Spark ML algorithms only accept data in a single vector column.  
This step ensures your dataset is in the correct format for model training.

